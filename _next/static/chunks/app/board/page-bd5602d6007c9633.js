(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[81],{70615:(e,t,r)=>{Promise.resolve().then(r.bind(r,56527))},56527:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>U});var a=r(57),s=r(67916),n=r(92974),i=r(49875),l=r(62424),o=r(93060),c=r(13709),d=r(8337),h=r(17571),u=r(96213),m=r(14109),f=r.n(m),g=r(93760);let p=e=>{let{children:t,title:r="Notification"}=e,[s,n]=(0,c.useState)(!0),{NODE_ENV:i}=g.env;return(0,a.jsx)(h.Ny,{children:s&&(0,a.jsx)(h.PY.div,{initial:{opacity:0,x:100,y:0},animate:{opacity:1,x:0,y:0},exit:{opacity:0,x:100,y:0},transition:{type:"spring",stiffness:300,damping:30},className:"\n          ".concat(f().notificationTopRightCorner," ").concat("development"===i?"right-16":"right-4","\n    "),children:(0,a.jsx)("div",{className:f().notificationBody,role:"alert",children:(0,a.jsxs)("div",{className:f().notificationBodyFlex,children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:f().title,children:r}),(0,a.jsx)("div",{className:f().message,children:t})]}),(0,a.jsx)("button",{onClick:()=>n(!1),className:f().closeButton,children:(0,a.jsx)(u.A,{size:16})})]})})})})};var x=r(7001),y=r.n(x);let w="game-grid",b="draggable:character";var v=r(20843),j=r.n(v);let N=e=>{let{character:t,index:r,isPlacementPossible:i}=e,{attributes:l,isDragging:o,listeners:d,setNodeRef:h}=(0,n.PM)({id:"character-".concat(r),data:{character:t,type:b},disabled:!i}),u=(0,c.useMemo)(()=>s.mQ.fromLabel(t.specialization).icon,[t.specialization]);return(0,a.jsxs)(c.Fragment,{children:[(0,a.jsxs)("div",{className:j().cardIcon,ref:h,...d,...l,children:[(0,a.jsx)(u,{className:j().cardIconInner}),(0,a.jsx)("span",{children:t.name})]}),(0,a.jsx)(n.Hd,{dropAnimation:null,children:o?(0,a.jsxs)("div",{className:j().cardIcon,children:[(0,a.jsx)(u,{className:j().cardIconInner}),(0,a.jsx)("span",{children:t.name})]}):(0,a.jsx)(a.Fragment,{})})]})};var _=r(43149),A=r.n(_);let R=(e,t)=>{for(let a of e.cells)for(let e of a){var r;if((null===(r=e.content)||void 0===r?void 0:r.characterIndex)===t)return!0}return!1},C=e=>{let{characters:t,grid:r}=e;return(0,a.jsx)(l.ZpM,{className:A().characterCard,children:(0,a.jsx)("div",{className:A().characterCardContent,children:t.map((e,t)=>(0,a.jsx)(N,{character:e,index:t,isPlacementPossible:!R(r,t)},"character-".concat(t)))})})};var E=r(50733),M=r(53323),I=r.n(M);let T=e=>{let{diceRoll:t,rollDice:r,startingPlayer:s}=e,[n,i]=(0,c.useState)(!0),[o,d]=(0,c.useState)(0);return(0,c.useEffect)(()=>{d(0===t["0"]?o:t["0"])},[t,o]),(0,a.jsx)(l.aFV,{backdrop:"blur",classNames:{body:I().modalBody,footer:I().modalBody},hideCloseButton:!s,isDismissable:!!s,isOpen:n,onClose:()=>i(!1),children:(0,a.jsxs)(l.$mQ,{children:[(0,a.jsxs)(l.cwr,{children:[(0,a.jsx)("h2",{className:I().title,children:"Dice Roll"}),(0,a.jsx)("p",{children:"Let the dices decide who begins.. it's either you or the enemy!"}),(0,a.jsxs)(h.Ny,{children:[(0,a.jsxs)("div",{className:I().scoreGrid,children:[(0,a.jsx)("div",{className:"font-bold",children:"Your score:"}),(0,a.jsx)("div",{children:o})]}),s&&"0"===s?(0,a.jsx)("p",{className:"font-bold",children:"You scored higher and are the first to move!"},"you-scored-higher"):(0,a.jsx)(c.Fragment,{},"placeholder-you-scored-higher"),s&&"0"!==s?(0,a.jsx)("p",{className:"font-bold",children:"Enemy scored higher and is the first to move!"},"enemy-scored-higher"):(0,a.jsx)(c.Fragment,{},"placeholder-enemy-scored-higher")]})]}),(0,a.jsx)(l.jlY,{children:(0,a.jsx)(E.Y0,{color:"secondary",onPress:r,isDisabled:0!==o,"data-testid":"button-roll-dice",children:"Roll Dice"})})]})})},S=e=>{let{close:t}=e;return(0,a.jsxs)("div",{className:y().introductionText,"data-testid":"game-explanation",children:[(0,a.jsx)("p",{className:"w-[50vw]",children:"Beneath Eldoria’s shimmering veneer—a city both fragile and ferocious, a dance of towering ambitions and whispered secrets—there exists a truth rarely spoken aloud. The Thieves’ Guild, whispered of in shadowed alleys and scrawled in half-hearted proclamations, is not the scourge some might imagine. No, their fingers may dance across purse strings and lockpicks, but their purpose delves far deeper than mere mischief."}),(0,a.jsx)("p",{className:"w-[50vw]",children:"For Eldoria rests precariously on the edge of chaos, a bright crown balanced atop the yawning maw of the underworld. Beneath its cobbled streets and glittering spires lies a labyrinth of ancient tunnels, a vast and shifting expanse where the dregs of the world convene. Beasts that should not have names, whispers that curdle thought itself, and dangers unseen crawl forth from this abyss, threatening to sunder the city above."}),(0,a.jsx)("p",{className:"w-[50vw]",children:"The Guild, for all its roguish swagger, is Eldoria’s first—and often only—line of defense. Their silent blades and unseen movements do not merely plunder; they guard. It is their watchful eyes and deft hands that keep the horrors below from ascending into the light. And so, the people of Eldoria, pragmatic to their core, have come to an unspoken accord. Let the Guild go about their business, for their business is all that keeps Eldoria's dreams aloft."}),(0,a.jsx)("p",{className:"w-[50vw]",children:"But now, the tides of darkness rise. Enemies gather, cunning and relentless, seeking to breach the heart of the city: the Core. This sacred nexus is no mere stonework—it is a threshold, the fragile seal between light and shadow. If they reach it, the underworld will spill forth, devouring all."}),(0,a.jsx)("p",{className:"w-[50vw]",children:"You stand here, not as an observer but as a defender, summoned by fate and bound by resolve. The Core must be protected. Eldoria’s future lies in your hands, even as its people slumber, unaware of the storm you will face in their name."}),(0,a.jsx)(E.Y0,{color:"secondary",onPress:()=>t(),"data-testid":"button-close-game-explanation",children:"Understood"})]})},B=(e,t,r,a,s,n)=>{if(e.ctrlKey){e.preventDefault();let i=Math.min(Math.max(t+(e.deltaY>0?1:-1),s),n);if(i===t)return;let l=document.getElementById(w);if(!l)return;let o=l.getBoundingClientRect(),c=(e.clientX-o.left)/o.width,d=(e.clientY-o.top)/o.height,h=r.startX+c*(r.endX-r.startX),u=r.startY+d*(r.endY-r.startY),m=h-c*i,f=u-d*i;return m+i>a&&(m=a-i),f+i>a&&(f=a-i),m<0&&(m=0),f<0&&(f=0),{newGridSize:i,startX:Math.round(m),startY:Math.round(f)}}},G=(e,t,r,a)=>e&&t?"bg-success/50":e?"bg-danger/50":r%2==0&&a%2==0||r%2==1&&a%2==1?"bg-secondary/10":"bg-secondary/30";var F=r(78856),L=r.n(F);let Y=e=>{let{cell:t,character:r}=e,{x:i,y:l}=t,{isOver:o,setNodeRef:d}=(0,n.zM)({id:"grid-field-".concat(i,"-").concat(l),data:{x:i,y:l,accepts:[]}}),h=G(o,!1,i,l),u=(0,c.useMemo)(()=>s.mQ.fromLabel(r.specialization).icon,[r.specialization]);return(0,a.jsxs)("div",{ref:d,className:"".concat(L().gridCell," ").concat(h),"data-testid":"cell-".concat(i,"-").concat(l),children:[(0,a.jsx)(u,{className:L().gridCellText}),(0,a.jsx)("span",{className:L().gridCellText,"data-testid":"character-cell-race",children:r.race})]})};var P=r(32788);let k=e=>{let{cell:t}=e,{x:r,y:s}=t,{isOver:i,setNodeRef:l}=(0,n.zM)({id:"grid-field-".concat(r,"-").concat(s),data:{x:r,y:s,accepts:[]}}),o=G(i,!1,r,s);return(0,a.jsx)("div",{ref:l,className:"".concat(L().gridCell," ").concat(o),"data-testid":"cell-".concat(r,"-").concat(s),children:(0,a.jsx)(P.A,{})})},D=e=>{let{cell:t}=e,{x:r,y:s}=t,{isOver:i,setNodeRef:l}=(0,n.zM)({id:"grid-field-".concat(r,"-").concat(s),data:{x:r,y:s,accepts:[b]}}),o=G(i,!0,r,s);return(0,a.jsx)("div",{ref:l,className:"".concat(L().gridCell," ").concat(o),"data-testid":"cell-".concat(r,"-").concat(s),children:(0,a.jsxs)("span",{className:L().gridCellText,children:["(",r,", ",s,")"]})})};class H{constructor(){this.toViewModel=(e,t,r)=>{let{startX:n,endX:i,startY:l,endY:o}=t,c=e.cells.length,d=[];for(let t=l;t<o;t++)for(let l=n;l<i;l++)if(l>=0&&l<c&&t>=0&&t<c&&e.cells[t]&&e.cells[t][l]){let n=e.cells[t][l],i="".concat(l,",").concat(t);if(!n.content){d.push({x:l,y:t,draw:()=>(0,a.jsx)(D,{cell:n},i)});continue}switch(n.content.type){case s.wi:{let e={x:l,y:t,draw:()=>void 0};n.content.characterIndex&&r[n.content.characterIndex]?e.draw=()=>(0,a.jsx)(Y,{cell:n,character:r[n.content.characterIndex]},i):e.draw=()=>(0,a.jsx)(D,{cell:n},i),d.push(e);break}case s.Yj:d.push({x:l,y:t,draw:()=>(0,a.jsx)(k,{cell:n},i)})}}return d}}}var O=r(28065),z=r.n(O);let W=e=>{e.preventDefault()},Q=e=>{let{grid:t,team:r,gameViewModelMapper:s=new H}=e,n=t.cells.length,[i,l]=(0,c.useState)(10),[o,d]=(0,c.useState)({x:0,y:0}),[h,u]=(0,c.useState)({startX:o.x,endX:i,startY:o.y,endY:i}),[m]=(0,c.useState)(!1);(0,c.useEffect)(()=>{var e;return null===(e=document.getElementById(w))||void 0===e||e.addEventListener("wheel",W,{passive:!1}),()=>{var e;null===(e=document.getElementById(w))||void 0===e||e.removeEventListener("wheel",W)}},[]),(0,c.useEffect)(()=>u({startX:o.x,endX:o.x+i,startY:o.y,endY:o.y+i}),[o,i]);let f=(0,c.useMemo)(()=>s.toViewModel(t,h,r),[s,t,h,r]);return(0,c.useEffect)(()=>{d({x:Math.floor((n-10)/2),y:Math.floor((n-10)/2)}),l(10)},[n]),(0,a.jsx)("div",{className:z().gameGridContainer,children:(0,a.jsx)("div",{id:w,className:"".concat(z().gameGrid," ").concat(m?"cursor-grabbing":"cursor-grab"),onWheel:e=>{let t=B(e,i,h,n,4,12);t&&(l(t.newGridSize),d({x:t.startX,y:t.startY}))},style:{display:"grid",gridTemplateColumns:"repeat(".concat(i,", 1fr)")},children:f.map(e=>e.draw())})})},X=e=>{let{ctx:t,G:r,moves:s}=e,[h,u]=(0,c.useState)(null),[m,f]=(0,c.useState)(!0),g=(0,o.useRouter)();return((0,c.useEffect)(()=>{let e=(0,d.RQ)();!h&&e?u(e):h||e||g.push("/configuration")},[h,g]),(0,c.useEffect)(()=>{h&&s.initGame&&s.initGame(h)},[h,s]),(0,c.useEffect)(()=>{t.phase!==i.Zz&&(0,d.kQ)()},[t.phase]),r.showHints&&m)?(0,a.jsx)(S,{close:()=>f(!1)}):t.phase&&t.phase!==i.Zz?(0,a.jsxs)(n.Mp,{onDragEnd:e=>{if(!e.over||!s.placeCharacter)return;let t=e.active.data.current,r=e.over.data.current;t&&r&&s.placeCharacter(t.character,r.x,r.y)},children:[s.rollDice?(0,a.jsx)(T,{diceRoll:r.diceRoll,rollDice:s.rollDice,startingPlayer:r.startingPlayer}):(0,a.jsx)(a.Fragment,{}),(0,a.jsx)(Q,{grid:r.grid,team:r.team}),r.showHints&&t.phase===i.eL?(0,a.jsx)(p,{title:"Ah, my dear friend, let me guide you through this peculiar little endeavor.",children:(0,a.jsx)("p",{children:"Cast your gaze upon the bar below, where the characters await, each brimming with quiet purpose. Gently take hold of them - yes, just so - and place them upon the grid, as one would carefully lay stones for a hearth. Only when all have found their proper place will the game unfold, like the turning of a great and wondrous key."})}):(0,a.jsx)(a.Fragment,{}),t.phase===i.eL?(0,a.jsx)(C,{characters:r.team,grid:r.grid}):(0,a.jsx)(a.Fragment,{})]}):(0,a.jsxs)("div",{className:y().main,children:[(0,a.jsx)(l.y$y,{color:"secondary"}),(0,a.jsx)("p",{className:"ml-2",children:"Game is Loading, hang on a second..."})]})},U=()=>{let e=(0,s.Kj)({game:s.vW,board:X,numPlayers:2});return(0,a.jsx)(e,{})}},8337:(e,t,r)=>{"use strict";r.d(t,{RQ:()=>n,Vd:()=>s,kQ:()=>i});let a=Object.freeze("eldoria-configuration"),s=e=>{localStorage.setItem(a,JSON.stringify(e))},n=()=>{let e=localStorage.getItem(a);if(e)try{return JSON.parse(e)}catch(e){console.error("Failed to parse stored configuration:",e)}return null},i=()=>{localStorage.removeItem(a)}},67916:(e,t,r)=>{"use strict";r.d(t,{Df:()=>M,wi:()=>s,Yj:()=>n,Kj:()=>a.K,st:()=>E,vW:()=>f,Fv:()=>i,XD:()=>C,oF:()=>x,lb:()=>I,mQ:()=>A,xi:()=>R,qs:()=>g});var a=r(68008);let s="cell:character",n="cell:core",i=6,l=()=>{let e=[];for(let t=0;t<64;t++){let r=[];for(let e=0;e<64;e++){let a=(31===e||32===e)&&(31===t||32===t);r[e]={x:e,y:t,content:a?{type:n}:void 0}}e.push(Object.freeze(r))}return{cells:Object.freeze(e)}};var o=r(49875);let c=(e,t,r,a)=>!!e.cells[a]&&!!e.cells[a][r]&&!e.cells[a][r].content,d=e=>{let{ctx:t}=e;return(t.playOrderPos+1)%t.numPlayers},h={moves:{initGame:(e,t)=>{let{G:r,ctx:a}=e,{username:s,team:n,tutorial:i,showHints:l}=t;r.username=s,r.team=n,r.tutorial=i,r.showHints=l;for(let e=0;e<a.numPlayers;e++)r.diceRoll["".concat(e)]=0}},next:o.GV,endIf:e=>{let{G:t}=e;return!!t.username},start:!0};var u=r(66196);let m={moves:{rollDice:e=>{let{G:t,ctx:r,events:a,random:s}=e;if(!Object.keys(t.diceRoll).includes(r.currentPlayer))return u.n;t.diceRoll[r.currentPlayer]=s.D20(),0!==t.diceRoll["0"]&&0!==t.diceRoll["1"]&&(t.diceRoll["0"]===t.diceRoll["1"]?t.diceRoll={0:0,1:0}:t.startingPlayer=t.diceRoll["0"]>t.diceRoll["1"]?"0":"1"),a.endTurn()}},next:o.eL,turn:{order:{first:()=>0,next:d}},endIf:e=>{let{G:t}=e;return!!t.startingPlayer},onEnd:e=>{let{G:t}=e;t.diceRoll={0:0,1:0}}},f={name:"fantasy-board-game",minPlayers:2,maxPlayers:2,setup:()=>({diceRoll:{0:0,1:0},grid:l(),startingPlayer:void 0,team:[],username:"",tutorial:!1,showHints:!0}),moves:{},turn:{minMoves:1,maxMoves:1},phases:{[o.Zz]:h,[o.GV]:m,[o.eL]:{moves:{placeCharacter:(e,t,r,a)=>{let{G:n}=e,i=n.team.findIndex(e=>e.name===t.name);c(n.grid,t,r,a)&&i>=0&&(n.grid.cells[a][r].content={type:s,characterIndex:i})}},next:"phaseB",turn:{order:{first:()=>0,next:d,playOrder:e=>{let{G:t}=e;return"0"===t.startingPlayer?["0","1"]:["1","0"]}}}},phaseB:{}}},g=(e,t,r)=>{let a=t.baseDexterity+r.dexterityMod,s=10+Math.floor(a/2)-5+r.acBonus,n=t.baseConstitution+r.constitutionMod,i=100+r.hpBonus+5*n;return new p(e,t.label,r.label,i,s,t.baseStrength+r.strengthMod,a,n,t.baseIntelligence+r.intelligenceMod,t.baseWisdom+r.wisdomMod,t.baseCharisma+r.charismaMod)};class p{constructor(e,t,r,a,s,n,i,l,o,c,d){this.name=e,this.race=t,this.specialization=r,this.maxHP=a,this.ac=s,this.strength=n,this.dexterity=i,this.constitution=l,this.intelligence=o,this.wisdom=c,this.charisma=d}}class x{static fromLabel(e){switch(e.trim().toLowerCase()){case"human":return x.HUMAN;case"dwarf":return x.DWARF;case"elf":return x.ELF;case"halfling":return x.HALFLING;case"giant":return x.GIANT;default:throw Error("Unknown race label: ".concat(e))}}constructor(e,t,r,a,s,n,i){this.label=e,this.baseStrength=t,this.baseDexterity=r,this.baseConstitution=a,this.baseIntelligence=s,this.baseWisdom=n,this.baseCharisma=i}}x.HUMAN=new x("Human",10,10,10,10,10,10),x.DWARF=new x("Dwarf",12,8,13,10,11,9),x.ELF=new x("Elf",8,12,9,12,11,11),x.HALFLING=new x("Halfling",8,13,10,10,11,12),x.GIANT=new x("Giant",14,6,13,7,10,8);var y=r(64444),w=r(24973),b=r(78908),v=r(42057),j=r(27619),N=r(16649),_=r(10468);class A{static fromLabel(e){switch(e.trim().toLowerCase()){case"tank":return A.TANK;case"warrior":return A.WARRIOR;case"assassin":return A.ASSASSIN;case"archer":return A.ARCHER;case"mage":return A.MAGE;case"healer":return A.HEALER;case"buffer":return A.BUFFER;default:throw Error("Unknown specialization label: ".concat(e))}}constructor(e,t,r,a,s,n,i,l,o,c){this.label=e,this.icon=t,this.hpBonus=r,this.acBonus=a,this.strengthMod=s,this.dexterityMod=n,this.constitutionMod=i,this.intelligenceMod=l,this.wisdomMod=o,this.charismaMod=c}}A.TANK=new A("Tank",y.A,50,3,2,0,3,-1,1,0),A.WARRIOR=new A("Warrior",w.A,30,1,3,1,1,0,0,0),A.ASSASSIN=new A("Assassin",b.A,10,1,1,4,0,1,1,0),A.ARCHER=new A("Archer",v.A,20,0,1,3,0,1,2,0),A.MAGE=new A("Mage",j.A,0,0,-1,1,0,4,2,1),A.HEALER=new A("Healer",N.A,20,0,0,0,1,1,4,1),A.BUFFER=new A("Buffer",_.A,10,0,0,1,1,2,2,2);let R=g("Thane",x.DWARF,A.TANK),C=g("Nyssa",x.HUMAN,A.ASSASSIN),E=g("Elyndor",x.DWARF,A.MAGE),M=g("Brom",x.GIANT,A.WARRIOR),I=g("Selene",x.ELF,A.HEALER)},49875:(e,t,r)=>{"use strict";r.d(t,{GV:()=>s,Zz:()=>a,eL:()=>n});let a="INIT",s="ROLL_PHASE",n="GATHER_GROUP"},50733:(e,t,r)=>{"use strict";r.d(t,{Y0:()=>n,o3:()=>u});var a=r(57),s=r(32234);let n=(0,r(13709).forwardRef)((e,t)=>{let{children:r,color:n="primary",type:i="button",...l}=e;return(0,a.jsx)(s.T,{color:n,ref:t,type:i,...l,children:r})});n.displayName="DefaultButton";var i=r(9895),l=r(50609),o=r(50426),c=r(94485),d=r(74898),h=r.n(d);let u=e=>{let{ariaLabel:t,items:r,label:s,onSelectionChange:d}=e;return(0,a.jsxs)(i.A,{className:h().dropdown,children:[(0,a.jsx)(l.b,{children:(0,a.jsx)(n,{className:"transition-transform",color:"secondary",children:s})}),(0,a.jsx)(o.y,{"aria-label":t,variant:"flat",disallowEmptySelection:!0,items:r,onSelectionChange:d,selectionMode:"single",children:e=>(0,a.jsx)(c.Y,{color:"default",children:e.label},e.label)})]})}},62424:(e,t,r)=>{"use strict";r.d(t,{e2v:()=>a.e2v,ZpM:()=>a.ZpM,Sc0:()=>a.Sc0,pde:()=>a.pde,aFV:()=>a.aFV,cwr:()=>a.cwr,$mQ:()=>a.$mQ,jlY:()=>a.jlY,y$y:()=>a.y$y}),r(50733),r(17571),r(99150);var a=r(36729)},17571:(e,t,r)=>{"use strict";r.d(t,{Ny:()=>a.Ny,PY:()=>a.PY});var a=r(29650);r(204)},99150:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AppUIProvider:()=>i,NextThemeProvider:()=>l});var a=r(57),s=r(51558),n=r(204);let i=e=>{let{children:t}=e;return(0,a.jsx)(s.b,{children:t})},l=e=>{let{children:t,themeProps:r}=e;return(0,a.jsx)(n.N,{defaultTheme:"system",themes:["light","dark","system"],forcedTheme:"light",...r,children:t})}},7001:e=>{e.exports={main:"board_main__092fm",introductionText:"board_introductionText___1NlX"}},78856:e=>{e.exports={gridCell:"grid-cell_gridCell__1D4fJ",gridCellText:"grid-cell_gridCellText__LcWyb"}},20843:e=>{e.exports={cardIcon:"character-card_cardIcon__pgQsj",cardIconInner:"character-card_cardIconInner__fpUF2"}},43149:e=>{e.exports={characterCard:"character-bar_characterCard__VOO8M",characterCardContent:"character-bar_characterCardContent__mInNT"}},53323:e=>{e.exports={modalBody:"dice-roll_modalBody__1lOfR",title:"dice-roll_title__siwTN",scoreGrid:"dice-roll_scoreGrid__TeH2C"}},28065:e=>{e.exports={gameGridContainer:"infinite-grid_gameGridContainer__Dw42M",gameGrid:"infinite-grid_gameGrid__OWNqN"}},14109:e=>{e.exports={notificationTopRightCorner:"notification_notificationTopRightCorner__RlN_9",notificationBody:"notification_notificationBody__4xjYG",notificationBodyFlex:"notification_notificationBodyFlex__dMiOn",title:"notification_title__t7HbK",message:"notification_message__A5AjY",closeButton:"notification_closeButton__RxYT2"}},74898:e=>{e.exports={dropdown:"dropdown-for-list-items_dropdown__grQjg"}}},e=>{var t=t=>e(e.s=t);e.O(0,[904,552,502,775,789,782,745,358],()=>t(70615)),_N_E=e.O()}]);