(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[81],{92334:(e,t,r)=>{Promise.resolve().then(r.bind(r,6650))},6650:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>S});var s=r(68320),a=r(98353),l=r(3276),n=r(44959),i=r(43517),o=r(53411),c=r(10349);let d=e=>{let{characters:t}=e,r=(e,t)=>{e.dataTransfer.setData("character",String(t))},l=(e,t,l)=>{let n=a.mQ.fromLabel(l).icon;return console.log("render:",e),(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center transition-all cursor-move rounded-lg border-2 border-border hover:border-primary hover:scale-110 p-2",children:[(0,s.jsx)("div",{draggable:!0,onDragStart:t=>r(t,e),children:(0,s.jsx)(n,{className:"text-secondary text-small"})}),(0,s.jsx)("span",{children:t})]},"character-icon-".concat(e))};return console.log("characters:",t),(0,s.jsx)(i.ZpM,{className:"fixed bottom-0 left-0 right-0 pb-2 pt-2 supports-[backdrop-filter]:bg-background/60 z-50 border-t",children:(0,s.jsx)("div",{className:"flex items-center justify-center h-full gap-8 px-4",children:t.map((e,t)=>{let{name:r,specialization:s}=e;return l(t,r,s)})})})};var h=r(22866),u=r(56097),m=r(6855),f=r.n(m);let g=e=>{let{diceRoll:t,rollDice:r,startingPlayer:a}=e,[n,i]=(0,l.useState)(!0),[o,c]=(0,l.useState)(0);return(0,l.useEffect)(()=>{c(0===t["0"]?o:t["0"])},[t]),(0,s.jsx)(u.aF,{backdrop:"blur",classNames:{body:f().modalBody,footer:f().modalBody},hideCloseButton:!a,isDismissable:!!a,isOpen:n,onClose:()=>i(!1),children:(0,s.jsxs)(u.$m,{children:[(0,s.jsxs)(u.cw,{children:[(0,s.jsx)("h2",{className:f().title,children:"Dice Roll"}),(0,s.jsx)("p",{children:"Let the dices decide who begins.. it's either you or the enemy!"}),(0,s.jsxs)(u.Ny,{mode:"wait",children:[(0,s.jsxs)("div",{className:f().scoreGrid,children:[(0,s.jsx)("div",{className:"font-bold",children:"Your score:"}),(0,s.jsx)("div",{children:o})]}),a&&"0"===a?(0,s.jsx)("p",{className:"font-bold",children:"You scored higher and are the first to move!"}):null,a&&"0"!==a?(0,s.jsx)("p",{className:"font-bold",children:"Enemy scored higher and is the first to move!"}):null]})]}),(0,s.jsx)(u.jl,{children:(0,s.jsx)(h.Y0,{color:"secondary",onClick:r,isDisabled:0!==o,"data-testid":"button-roll-dice",children:"Roll Dice"})})]})})},x=(e,t,r)=>{let s=e.x-Math.floor(t/2),a=e.x+Math.ceil(t/2),l=e.y-Math.floor(t/2),n=e.y+Math.ceil(t/2);return s<0&&(a-=s,s=0),a>r&&(s-=a-r,a=r),l<0&&(n-=l,l=0),n>r&&(l-=n-r,n=r),{startX:s,endX:a,startY:l,endY:n}},y=(e,t,r,s,a,l)=>{if(e.ctrlKey){e.preventDefault();let n=Math.min(Math.max(t+(e.deltaY>0?1:-1),a),l);if(n===t)return;let i=document.getElementById(A);if(!i)return;let o=i.getBoundingClientRect(),c=(e.clientX-o.left)/o.width,d=(e.clientY-o.top)/o.height,h=Math.floor(c*t),u=Math.floor(d*t),m=r.startX+h,f=r.startY+u,g=Math.round(m-(c-.5)*n),x=Math.round(f-(d-.5)*n);return g=Math.min(Math.max(Math.floor(n/2),g),s-Math.ceil(n/2)),x=Math.min(Math.max(Math.floor(n/2),x),s-Math.ceil(n/2)),{newGridSize:n,newCenterX:g,newCenterY:x}}},p=e=>{e.preventDefault()},b=e=>"(".concat(e.x,",").concat(e.y,")"),v=(e,t)=>{let{startX:r,endX:a,startY:l,endY:n}=e,i=t.cells.length,o=[];for(let e=l;e<n;e++)for(let l=r;l<a;l++)if(l>=0&&l<i&&e>=0&&e<i){let r=t.cells[e][l];o.push((0,s.jsx)("div",{style:{border:"1px solid",display:"flex",alignItems:"center",justifyContent:"center"},children:b(r)},"".concat(r.x,",").concat(r.y)))}return o};var j=r(97037),w=r.n(j);let A="game-grid",M=e=>{let{grid:t}=e,r=t.cells.length,a=(0,l.useMemo)(()=>Math.floor(r/2),[r]),[n,i]=(0,l.useState)({x:a,y:a}),[o,c]=(0,l.useState)(10),[d,h]=(0,l.useState)({startX:0,endX:10,startY:0,endY:10}),[u]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{var e;return null===(e=document.getElementById(A))||void 0===e||e.addEventListener("wheel",p,{passive:!1}),()=>{var e;null===(e=document.getElementById(A))||void 0===e||e.removeEventListener("wheel",p)}},[p]),(0,l.useEffect)(()=>h(x(n,o,r)),[n,o]),(0,s.jsx)("div",{className:w().gameGridContainer,children:(0,s.jsx)("div",{id:A,className:"".concat(w().gameGrid," ").concat(u?"cursor-grabbing":"cursor-grab"),onWheel:e=>{let t=y(e,o,d,r,4,12);t&&(c(t.newGridSize),i({x:t.newCenterX,y:t.newCenterY}))},style:{display:"grid",gridTemplateColumns:"repeat(".concat(o,", 1fr)")},children:v(d,t)})})};var R=r(23653),N=r.n(R);let E=e=>{let{ctx:t,G:r,moves:a}=e,[h,u]=(0,l.useState)(null),m=(0,n.useRouter)();return((0,l.useEffect)(()=>{let e=(0,o.RQ)();!h&&e?u(e):h||e||m.push("/configuration")},[]),(0,l.useEffect)(()=>{h&&a.initGame&&a.initGame(h)},[h]),(0,l.useEffect)(()=>{t.phase!==c.Zz&&(0,o.kQ)()},[t.phase]),t.phase&&t.phase!==c.Zz)?(0,s.jsxs)("div",{children:[a.rollDice?(0,s.jsx)(g,{diceRoll:r.diceRoll,rollDice:a.rollDice,startingPlayer:r.startingPlayer}):null,(0,s.jsx)(M,{grid:r.grid}),t.phase===c.eL?(0,s.jsx)(d,{characters:r.team}):null]}):(0,s.jsxs)("div",{className:N().main,children:[(0,s.jsx)(i.y$y,{color:"secondary"}),(0,s.jsx)("p",{className:"ml-2",children:"Game is Loading, hang on a second..."})]})},S=()=>{let e=(0,a.Kj)({game:a.vW,board:E,numPlayers:2});return(0,s.jsx)(e,{})}},53411:(e,t,r)=>{"use strict";r.d(t,{RQ:()=>l,Vd:()=>a,kQ:()=>n});let s=Object.freeze("eldoria-configuration"),a=e=>{localStorage.setItem(s,JSON.stringify(e))},l=()=>{let e=localStorage.getItem(s);if(e)try{return JSON.parse(e)}catch(e){console.error("Failed to parse stored configuration:",e)}return null},n=()=>{localStorage.removeItem(s)}},98353:(e,t,r)=>{"use strict";r.d(t,{Df:()=>R,Kj:()=>E.K,st:()=>M,vW:()=>d,Fv:()=>s,XD:()=>A,oF:()=>m,lb:()=>N,mQ:()=>j,xi:()=>w,qs:()=>h});let s=6,a=()=>{let e=[];for(let t=0;t<64;t++){let r=[];for(let e=0;e<64;e++)r[e]={x:e,y:t};e.push(Object.freeze(r))}return{cells:Object.freeze(e)}};var l=r(10349);let n=e=>{let{ctx:t}=e;return(t.playOrderPos+1)%t.numPlayers},i={moves:{initGame:(e,t)=>{let{G:r,ctx:s}=e,{username:a,team:l}=t;r.username=a,r.team=l;for(let e=0;e<s.numPlayers;e++)r.diceRoll["".concat(e)]=0}},next:l.GV,endIf:e=>{let{G:t}=e;return!!t.username},start:!0};var o=r(83157);let c={moves:{rollDice:e=>{let{G:t,ctx:r,events:s,random:a}=e;if(!Object.keys(t.diceRoll).includes(r.currentPlayer))return o.n;t.diceRoll[r.currentPlayer]=a.D20(),0!==t.diceRoll["0"]&&0!==t.diceRoll["1"]&&(t.diceRoll["0"]===t.diceRoll["1"]?t.diceRoll={0:0,1:0}:t.startingPlayer=t.diceRoll["0"]>t.diceRoll["1"]?"0":"1"),s.endTurn()}},next:l.eL,turn:{order:{first:()=>0,next:n}},endIf:e=>{let{G:t}=e;return!!t.startingPlayer},onEnd:e=>{let{G:t}=e;t.diceRoll={0:0,1:0}}},d={name:"fantasy-board-game",minPlayers:2,maxPlayers:2,setup:()=>({diceRoll:{0:0,1:0},grid:a(),startingPlayer:void 0,team:[],username:""}),moves:{},turn:{minMoves:1,maxMoves:1},phases:{[l.Zz]:i,[l.GV]:c,[l.eL]:{moves:{placeCharacter:()=>{}},next:"phaseB",turn:{order:{first:()=>0,next:n,playOrder:e=>{let{G:t}=e;return"0"===t.startingPlayer?["0","1"]:["1","0"]}}}},phaseB:{}}},h=(e,t,r)=>{let s=t.baseDexterity+r.dexterityMod,a=10+Math.floor(s/2)-5+r.acBonus,l=t.baseConstitution+r.constitutionMod,n=100+r.hpBonus+5*l;return new u(e,t.label,r.label,n,a,t.baseStrength+r.strengthMod,s,l,t.baseIntelligence+r.intelligenceMod,t.baseWisdom+r.wisdomMod,t.baseCharisma+r.charismaMod)};class u{constructor(e,t,r,s,a,l,n,i,o,c,d){this.name=e,this.race=t,this.specialization=r,this.maxHP=s,this.ac=a,this.strength=l,this.dexterity=n,this.constitution=i,this.intelligence=o,this.wisdom=c,this.charisma=d}}class m{static fromLabel(e){switch(e.trim().toLowerCase()){case"human":return m.HUMAN;case"dwarf":return m.DWARF;case"elf":return m.ELF;case"halfling":return m.HALFLING;case"giant":return m.GIANT;default:throw Error("Unknown race label: ".concat(e))}}constructor(e,t,r,s,a,l,n){this.label=e,this.baseStrength=t,this.baseDexterity=r,this.baseConstitution=s,this.baseIntelligence=a,this.baseWisdom=l,this.baseCharisma=n}}m.HUMAN=new m("Human",10,10,10,10,10,10),m.DWARF=new m("Dwarf",12,8,13,10,11,9),m.ELF=new m("Elf",8,12,9,12,11,11),m.HALFLING=new m("Halfling",8,13,10,10,11,12),m.GIANT=new m("Giant",14,6,13,7,10,8);var f=r(98255),g=r(28704),x=r(42411),y=r(46194),p=r(77904),b=r(39706),v=r(13633);class j{static fromLabel(e){switch(e.trim().toLowerCase()){case"tank":return j.TANK;case"warrior":return j.WARRIOR;case"assassin":return j.ASSASSIN;case"archer":return j.ARCHER;case"mage":return j.MAGE;case"healer":return j.HEALER;case"buffer":return j.BUFFER;default:throw Error("Unknown specialization label: ".concat(e))}}constructor(e,t,r,s,a,l,n,i,o,c){this.label=e,this.icon=t,this.hpBonus=r,this.acBonus=s,this.strengthMod=a,this.dexterityMod=l,this.constitutionMod=n,this.intelligenceMod=i,this.wisdomMod=o,this.charismaMod=c}}j.TANK=new j("Tank",f.A,50,3,2,0,3,-1,1,0),j.WARRIOR=new j("Warrior",g.A,30,1,3,1,1,0,0,0),j.ASSASSIN=new j("Assassin",x.A,10,1,1,4,0,1,1,0),j.ARCHER=new j("Archer",y.A,20,0,1,3,0,1,2,0),j.MAGE=new j("Mage",p.A,0,0,-1,1,0,4,2,1),j.HEALER=new j("Healer",b.A,20,0,0,0,1,1,4,1),j.BUFFER=new j("Buffer",v.A,10,0,0,1,1,2,2,2);let w=h("Thane",m.DWARF,j.TANK),A=h("Nyssa",m.HUMAN,j.ASSASSIN),M=h("Elyndor",m.DWARF,j.MAGE),R=h("Brom",m.GIANT,j.WARRIOR),N=h("Selene",m.ELF,j.HEALER);var E=r(69381)},10349:(e,t,r)=>{"use strict";r.d(t,{GV:()=>a,Zz:()=>s,eL:()=>l});let s="INIT",a="ROLL_PHASE",l="GATHER_GROUP"},79870:(e,t,r)=>{"use strict";r.d(t,{A:()=>i,Y:()=>n});var s=r(68320),a=r(3276),l=r(15314);let n=(0,a.forwardRef)((e,t)=>{let{children:r,color:a="primary",type:n="button",...i}=e;return(0,s.jsx)(l.T,{color:a,ref:t,type:n,...i,children:r})}),i=n},22866:(e,t,r)=>{"use strict";r.d(t,{Y0:()=>s.Y,o3:()=>h});var s=r(79870),a=r(68320),l=r(81521),n=r(85764),i=r(79643),o=r(52350),c=r(38638),d=r.n(c);let h=e=>{let{ariaLabel:t,items:r,label:c,onSelectionChange:h}=e;return(0,a.jsxs)(l.A,{className:d().dropdown,children:[(0,a.jsx)(n.b,{children:(0,a.jsx)(s.A,{className:"transition-transform",color:"secondary",children:c})}),(0,a.jsx)(i.y,{"aria-label":t,variant:"flat",disallowEmptySelection:!0,items:r,onSelectionChange:h,selectionMode:"single",children:e=>(0,a.jsx)(o.Y,{color:"default",children:e.label},e.label)})]})}},43517:(e,t,r)=>{"use strict";r.d(t,{e2v:()=>s.e2v,ZpM:()=>s.ZpM,pde:()=>s.pde,y$y:()=>s.y$y}),r(22866),r(56097),r(62092);var s=r(68113)},56097:(e,t,r)=>{"use strict";r.d(t,{Ny:()=>s.Ny,aF:()=>a.Y,cw:()=>l.h,$m:()=>n.g,jl:()=>i.q,PY:()=>s.PY});var s=r(66311);r(3144);var a=r(77978),l=r(10611),n=r(83748),i=r(73695)},62092:(e,t,r)=>{"use strict";r.r(t),r.d(t,{AppUIProvider:()=>n,NextThemeProvider:()=>i});var s=r(68320),a=r(82872),l=r(3144);let n=e=>{let{children:t}=e;return(0,s.jsx)(a.b,{children:t})},i=e=>{let{children:t,themeProps:r}=e;return(0,s.jsx)(l.N,{defaultTheme:"system",themes:["light","dark","system"],forcedTheme:"light",...r,children:t})}},23653:e=>{e.exports={main:"board_main__092fm"}},6855:e=>{e.exports={modalBody:"dice-roll_modalBody__1lOfR",title:"dice-roll_title__siwTN",scoreGrid:"dice-roll_scoreGrid__TeH2C"}},97037:e=>{e.exports={gameGridContainer:"infinite-grid_gameGridContainer__Dw42M",gameGrid:"infinite-grid_gameGrid__OWNqN"}},38638:e=>{e.exports={dropdown:"dropdown-for-list-items_dropdown__grQjg"}}},e=>{var t=t=>e(e.s=t);e.O(0,[112,344,735,370,901,863,358],()=>t(92334)),_N_E=e.O()}]);